{% extends 'core/base.html' %}

{% block content %}
<div class="header">
    <div>
        <h1 class="page-title">Inventario</h1>
        <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.25rem;">
            Valor Total: <span style="font-weight: 700; color: var(--text-main);">
                ${{ valor_inventario|floatformat:2 }}
            </span>
        </p>
    </div>
    <div style="display: flex; gap: 1rem;">
        <form method="get" style="display: flex; gap: 0.5rem;">
            <input type="text" name="q" class="form-control" placeholder="Buscar por nombre o SKU..."
                value="{{ request.GET.q|default:'' }}">
            <button type="submit" class="btn btn-outline" style="padding: 0.75rem;">üîç</button>
            {% if request.GET.q %}
            <a href="{% url 'lista_productos' %}" class="btn btn-outline"
                style="padding: 0.75rem; color: var(--danger); border-color: var(--danger);"
                title="Limpiar b√∫squeda">‚úï</a>
            {% endif %}
        </form>
        <a href="{% url 'crear_producto' %}" class="btn btn-primary">Nuevo Producto</a>
    </div>
</div>

<div class="card">
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>SKU</th>
                    <th>NOMBRE</th>
                    <th>CATEGOR√çA</th>
                    <th>PRECIO</th>
                    <th>STOCK</th>
                    <th>ACCIONES</th>
                </tr>
            </thead>
            <tbody>
                {% for p in productos %}
                <tr>
                    <td style="font-family: monospace; font-weight: 600;">{{ p.sku }}</td>
                    <td>{{ p.nombre }}</td>
                    <td>
                        <span class="badge" style="background: #f1f5f9; color: var(--text-muted);">
                            {{ p.categoria }}
                        </span>
                    </td>
                    <td>${{ p.precio }}</td>
                    <td style="font-weight: 700;" class="{% if p.cantidad < 5 %}text-danger{% endif %}">
                        {{ p.cantidad }}
                    </td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <a href="{% url 'registrar_movimiento' p.pk %}" class="btn btn-outline"
                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" title="Mover Stock">üîÑ</a>
                            <a href="{% url 'editar_producto' p.pk %}" class="btn btn-outline"
                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" title="Editar">‚úèÔ∏è</a>
                            <a href="{% url 'eliminar_producto' p.pk %}" class="btn btn-danger"
                                style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" title="Eliminar">üóëÔ∏è</a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 2rem;">No se encontraron productos.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}